<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>LINE ç·šä¸Šé ç´„</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- LIFF -->
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<!-- æ—¥æœŸå¥—ä»¶ flatpickr -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh-tw.js"></script>

<style>
  body {
    font-family: "Noto Sans TC", sans-serif;
    background: #f5f5f5;
    margin: 0;
    padding: 0;
  }

  .container {
    max-width: 480px;
    margin: 0 auto;
    padding: 20px;
  }

  /* é ‚éƒ¨æ­¡è¿è© */
  .welcome {
    font-size: 22px;
    margin-bottom: 20px;
    font-weight: 700;
  }
  .welcome span {
    color: #06C755; /* LINE ç¶  */
    font-weight: 900;
  }

  h2 {
    font-size: 20px;
    margin-bottom: 18px;
    text-align: center;
    font-weight: 900;
  }

  .section {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.06);
    margin-bottom: 20px;
  }

  .field-group {
    margin-bottom: 18px;
  }

  .field-group label {
    display: block;
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 6px;
  }

  .required {
    color: #d32f2f;
    font-weight: 700;
    margin-left: 4px;
  }

  input, select, textarea {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 8px;
    box-sizing: border-box;
  }

  /* æ—¥æœŸæ¬„ä½å°åœ–ç¤º */
  .date-group {
    position: relative;
  }
  .date-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
  }

  /* ç‡Ÿæ¥­æ—¥å‚™è¨» */
  .date-note {
    margin-top: 6px;
    font-size: 13px;
    color: #555;
  }

  button[type="submit"] {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 10px;
    background: #06C755;
    color: white;
    font-size: 18px;
    font-weight: 900;
    margin-top: 10px;
  }

</style>
</head>

<body>

<div class="container">

  <!-- é¡¯ç¤ºä½¿ç”¨è€…åç¨± -->
  <div class="welcome">
    ä½¿ç”¨è€… <span id="userName">æœ‹å‹</span> æ‚¨å¥½ï½
  </div>

  <h2>ç·šä¸Šé ç´„è¡¨å–®</h2>

  <div class="section">
    <form id="liffForm">

      <!-- éš±è—ï¼šUID / Email -->
      <input type="hidden" id="line_uid">
      <input type="hidden" id="line_email">

      <!-- æ‰‹æ©Ÿ -->
      <div class="field-group">
        <label>æ‰‹æ©Ÿ<span class="required">ï¼ˆå¿…å¡«ï¼‰</span></label>
        <input type="tel" id="phone" required placeholder="0912345678"
          maxlength="10" pattern="09[0-9]{8}" inputmode="numeric">
      </div>

      <!-- é ç´„æ—¥æœŸ -->
      <div class="field-group date-group">
        <label>é ç´„æ—¥æœŸ<span class="required">ï¼ˆå¿…å¡«ï¼‰</span></label>
        <input type="text" id="date" required placeholder="è«‹é¸æ“‡æ—¥æœŸ" readonly>
        <span class="date-icon">ğŸ“…</span>
        <div class="date-note">ç‡Ÿæ¥­æ—¥ï¼šå…­æ—¥ & åœ‹å®šå‡æ—¥</div>
      </div>

      <!-- é ç´„æ™‚æ®µ -->
      <div class="field-group">
        <label>é ç´„æ™‚æ®µ<span class="required">ï¼ˆå¿…å¡«ï¼‰</span></label>
        <select id="time" required>
          <option disabled selected>è«‹é¸æ“‡</option>
          <option>11:30</option>
          <option>13:30</option>
          <option>15:30</option>
        </select>
      </div>

      <!-- å¤§äººäººæ•¸ -->
      <div class="field-group">
        <label>å¤§äººäººæ•¸</label>
        <select id="adult">
          <option disabled selected>è«‹é¸æ“‡</option>
          <script>
            document.write(
              Array.from({length: 30}, (_, i)=> i+1)
              .map(n => `<option>${n} ä½</option>`).join("")
            );
          </script>
        </select>
      </div>

      <!-- å°å­©äººæ•¸ -->
      <div class="field-group">
        <label>å°å­©äººæ•¸</label>
        <select id="child">
          <option>ç„¡</option>
          <script>
            document.write(
              Array.from({length: 10}, (_, i)=> i+1)
              .map(n => `<option>${n} ä½</option>`).join("")
            );
          </script>
        </select>
      </div>

      <!-- å…’ç«¥åæ¤… -->
      <div class="field-group">
        <label>å…’ç«¥åæ¤…</label>
        <select id="seat">
          <option>ç„¡</option>
          <script>
            document.write(
              Array.from({length: 5}, (_, i)=> i+1)
              .map(n => `<option>${n} å¼µ</option>`).join("")
            );
          </script>
        </select>
      </div>

      <!-- å‚™è¨» -->
      <div class="field-group">
        <label>å‚™è¨»</label>
        <textarea id="note" rows="3" placeholder="å¯å¡«å¯«å‚™è¨»â€¦"></textarea>
      </div>

      <button type="submit">é€å‡ºé ç´„</button>

    </form>
  </div>

</div>

<script>
// ----------------------------
//     åˆå§‹åŒ– LIFF
// ----------------------------
async function initLIFF() {
  await liff.init({ liffId: "2008409020-k4Oy7Y0D" });

  if (!liff.isLoggedIn()) {
    liff.login({ redirectUri: window.location.href });
    return;
  }

  const profile = await liff.getProfile();
  const token = liff.getDecodedIDToken();

  document.getElementById("line_uid").value = profile.userId;
  document.getElementById("line_email").value = token?.email || "";

  // é¡¯ç¤ºä½¿ç”¨è€…åç¨±
  document.getElementById("userName").textContent = profile.displayName || "æœ‹å‹";
}

// ----------------------------
//     æ—¥æœŸé¸æ“‡å™¨
// ----------------------------
function initDatePicker() {
  flatpickr("#date", {
    locale: "zh_tw",
    dateFormat: "Y-m-d",
    minDate: "today"
  });
}

// ----------------------------
//     DOM Ready
// ----------------------------
document.addEventListener("DOMContentLoaded", () => {
  initLIFF();
  initDatePicker();
});

// ----------------------------
//     è¡¨å–®é€å‡º
// ----------------------------
document.getElementById("liffForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const params = new URLSearchParams();
  params.append("uid", document.getElementById("line_uid").value);
  params.append("email", document.getElementById("line_email").value);
  params.append("phone", document.getElementById("phone").value);
  params.append("date", document.getElementById("date").value);
  params.append("time", document.getElementById("time").value);
  params.append("adult", document.getElementById("adult").value);
  params.append("child", document.getElementById("child").value);
  params.append("seat", document.getElementById("seat").value);
  params.append("note", document.getElementById("note").value);

  window.location.href = "resultSend.html?" + params.toString();
});
</script>

</body>
</html>
